<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Studio Portfolio</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;700&display=swap" rel="stylesheet">
  <style>
    /* Global Reset and Base Styles */
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'Inter', sans-serif; /* Using Inter font */
      background-color: #ffffff; /* Pure white background */
      color: #1a1a1a; /* Darker text for contrast */
      line-height: 1.6; /* Slightly increased line height for readability */
      -webkit-font-smoothing: antialiased; /* Smoother fonts */
      -moz-osx-font-smoothing: grayscale;
    }

    /* Header Styling */
    .site-header {
      position: fixed; /* Stays on top when scrolling */
      top: 0;
      left: 0;
      width: 100%;
      padding: 40px 20px; /* Increased padding for more vertical space */
      background: transparent; /* Default transparent background */
      box-shadow: none; /* No shadow by default */
      z-index: 100;
      display: flex;
      justify-content: center; /* Centers the container within the header */
      align-items: center; /* Vertically centers content */
      transition: background-color 0.3s ease, color 0.3s ease, box-shadow 0.3s ease; /* Smooth transition for background and text color */
    }

    /* New class for scrolled header state */
    .site-header.scrolled {
      background-color: #ffffff; /* White background when scrolled */
      box-shadow: 0 2px 10px rgba(0,0,0,0.05); /* Subtle shadow when scrolled */
    }

    .site-header .container {
      max-width: 1400px;
      margin: 0 auto;
      width: 100%;
      display: flex;
      justify-content: space-between; /* Pushes logo to left, nav to right */
      align-items: center; /* Vertically centers logo and nav within container */
    }

    .site-header .logo {
      font-weight: 700;
      font-size: 1.5rem;
      color: #ffffff; /* Default white logo color */
      user-select: none;
      text-decoration: none;
      transition: color 0.3s ease; /* Smooth transition for logo color */
    }

    /* Color change for logo when header is scrolled */
    .site-header.scrolled .logo {
      color: #1a1a1a; /* Dark logo color when scrolled */
    }

    /* Desktop Navigation */
    .main-nav {
      display: flex; /* Show by default on desktop */
      justify-content: flex-end; /* Align nav links to the right */
      flex-wrap: wrap; /* Allow links to wrap */
    }

    .main-nav a {
      margin: 0 0 0 30px; /* Adjusted margin for spacing between links */
      text-decoration: none;
      color: #ffffff; /* Default white nav link color */
      font-weight: 400;
      font-size: 0.9rem;
      text-transform: uppercase;
      letter-spacing: 1.5px;
      transition: color 0.3s ease; /* Smooth transition for link color */
      padding: 5px 0;
    }

    /* Color change for nav links when header is scrolled */
    .site-header.scrolled .main-nav a {
      color: #1a1a1a; /* Dark nav link color when scrolled */
    }

    .main-nav a:first-child {
        margin-left: 0; /* No left margin for the first nav item */
    }

    .main-nav a:hover {
      color: #cccccc; /* Default hover color */
    }

    /* Hover color change for nav links when header is scrolled */
    .site-header.scrolled .main-nav a:hover {
      color: #777; /* Darker hover color when scrolled */
    }

    /* Hamburger Menu Icon */
    .hamburger-menu {
      display: none; /* Hidden by default on desktop */
      background: none;
      border: none;
      cursor: pointer;
      padding: 10px;
      position: relative;
      z-index: 101; /* Above mobile menu overlay */
    }

    .hamburger-menu .bar {
      display: block;
      width: 25px;
      height: 3px;
      margin: 5px auto;
      background-color: #ffffff; /* Default white bars */
      transition: all 0.3s ease-in-out; /* Smooth transition for bars */
    }

    /* Color change for hamburger bars when header is scrolled */
    .site-header.scrolled .hamburger-menu .bar {
      background-color: #1a1a1a; /* Dark bars when scrolled */
    }

    /* Mobile Navigation Overlay */
    .mobile-nav-overlay {
      position: fixed;
      top: 0;
      left: 0;
      width: 100vw;
      height: 100vh;
      background: rgba(255, 255, 255, 0.95); /* Semi-transparent white overlay */
      display: flex;
      justify-content: center;
      align-items: center;
      z-index: 99; /* Below hamburger, above content */
      opacity: 0;
      visibility: hidden;
      transition: opacity 0.3s ease-in-out, visibility 0.3s ease-in-out;
    }

    .mobile-nav-overlay.is-open {
      opacity: 1;
      visibility: visible;
    }

    .mobile-nav {
      display: flex;
      flex-direction: column;
      text-align: center;
    }

    .mobile-nav a {
      color: #1a1a1a; /* Dark text for mobile menu */
      text-decoration: none;
      font-size: 1.5rem; /* Larger font size for mobile links */
      padding: 15px 0;
      display: block;
      transition: color 0.3s ease;
    }

    .mobile-nav a:hover {
      color: #777;
    }

    /* Slider/Hero Section */
    .slider {
      position: relative;
      overflow: hidden;
      width: 100%;
      height: 100vh; /* Full viewport height for hero section */
      max-height: 100vh;
      /* margin-top: -120px; Added negative margin-top to pull slider up */
    }

    .slide-track {
      display: flex;
      transition: transform 1s ease-in-out;
      height: 100%;
    }

    /* Each slide now acts as a container for image and text */
    .slide {
      flex: 0 0 100%; /* Each slide takes full width */
      height: 100%;
      position: relative; /* Needed for absolute positioning of overlay */
    }

    .slide img {
      width: 100%;
      height: 100%;
      object-fit: cover;
      display: block;
    }

    /* Slider Overlay Text Styling - UPDATED */
    .slide-content {
      position: absolute;
      bottom: 50px; /* Position at the bottom */
      left: 50%;
      transform: translateX(-50%); /* Center horizontally */
      z-index: 5; /* Ensure text is above the image */
      color: #ffffff; /* White text for readability */
      text-align: center;
      width: 90%; /* Adjust width for smaller appearance */
      max-width: 800px; /* Max width to prevent it from getting too wide */
      padding: 20px 30px; /* Add some padding */
      background-color: rgba(0, 0, 0, 0); /* Slightly darker background for text readability */
      border-radius: 8px;
    }

    .slide-title {
      font-size: 2rem; /* Title is a bit smaller than before, still prominent */
      font-weight: 700;
      margin-bottom: 10px; /* Space between title and body */
      text-shadow: 1px 1px 3px rgba(0, 0, 0, 0.5); /* Subtle text shadow */
      line-height: 1.2;
      text-transform: uppercase; /* Match the image's uppercase style */
      letter-spacing: 2px;
    }

    .slide-body {
      font-size: 1rem; /* Smaller font size for the body text */
      font-weight: 400;
      line-height: 1.6;
      max-width: 600px; /* Limit body text width for readability */
      margin: 0 auto; /* Center the body text */
    }


    .dots {
      position: absolute;
      bottom: 30px;
      left: 50%;
      transform: translateX(-50%);
      display: flex;
      gap: 12px;
      z-index: 10;
    }

    .dot {
      width: 10px;
      height: 10px;
      border-radius: 50%;
      background-color: rgba(255, 255, 255, 0.6);
      cursor: pointer;
      transition: background-color 0.3s, transform 0.2s;
      border: 1px solid rgba(0, 0, 0, 0.2);
    }

    .dot.active {
      background-color: #ffffff;
      transform: scale(1.2);
    }

    /* Slider Navigation Arrows */
    .slider-arrow {
      position: absolute;
      top: 50%;
      transform: translateY(-50%);
      background: none; /* Transparent background */
      border: none;
      cursor: pointer;
      padding: 15px; /* Increased padding for larger clickable area */
      z-index: 10; /* Ensure arrows are above slider images */
      opacity: 0.7;
      transition: opacity 0.3s ease;
    }

    .slider-arrow:hover {
      opacity: 1;
    }

    .slider-arrow.left {
      left: 20px; /* Position from left edge */
    }

    .slider-arrow.right {
      right: 20px; /* Position from right edge */
    }

    .slider-arrow svg {
      width: 24px; /* Size of the arrow icon */
      height: 24px;
      fill: #ffffff; /* White arrow color */
    }


    /* Project List (Main Content) */
    .project-list {
      padding: 80px 40px; /* Increased padding around the grid */
      display: grid;
      /* Updated for a maximum of 3 columns, increasing width for larger screens */
      grid-template-columns: repeat(auto-fit, minmax(320px, 1fr)); /* Fallback for smaller screens */
      gap: 60px 40px; /* Reverted vertical and horizontal gap */
      max-width: 100%; /* Match header container width */
      margin: 0 auto; /* Center the project list */
    }

    @media (min-width: 1024px) { /* Adjust breakpoint as needed for "big screens" */
      .project-list {
        grid-template-columns: repeat(4, 1fr); /* Force 3 columns */
      }
    }

    /* Project Item Styling */
    .project {
      background: none;
      border: none;
      padding: 0;
      transition: transform 0.3s ease, opacity 0.3s ease;
      text-decoration: none;
      color: inherit;
      display: block;
    }

    .project:hover {
      transform: translateY(-8px);
      opacity: 0.9;
    }

    .project-thumbnail-container {
      margin-bottom: 25px; /* Space between image and text content */
      position: relative;
      overflow: hidden;
      line-height: 0; /* Remove extra space below image */
    }

    .project-thumbnail-container img {
      width: 100%;
      height: 500px; /* Reverted to default fixed height for project images */
      object-fit: cover; /* Ensure images cover the space */
      display: block;
      transition: transform 0.5s ease; /* Smooth zoom effect on hover */
    }

    .project:hover .project-thumbnail-container img {
      transform: scale(1.05); /* Slight zoom on image hover */
    }

    .project-info {
      text-align: left; /* Align text content to the left */
    }

    .project-title {
      font-size: 1.35rem; /* Reverted to original title size */
      font-weight: 500;
      margin-bottom: 10px; /* Space between title and description */
      line-height: 1.2;
    }

    .project-description {
      font-size: 1rem;
      color: #555; /* Slightly lighter color for description */
      margin-bottom: 15px; /* Space between description and category/year */
      line-height: 1.5;
    }

    .project-meta {
      font-size: 0.85rem; /* Smaller font for meta info */
      color: #888; /* Lighter color for meta info */
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }

    /* "Latest Work" Title Styling */
    .section-title {
        text-align: center;
        font-size: 2.5rem; /* Large, prominent title */
        font-weight: 700;
        margin-bottom: 60px; /* Space below the title */
        padding-top: 80px; /* Padding to push it below the slider */
        text-transform: uppercase;
        letter-spacing: 2px;
        color: #1a1a1a;
    }

    /* Divider Section Styling */
    .divider-section {
      position: relative;
      width: 100%;
      height: 60vh; /* Adjust height as needed */
      overflow: hidden;
      display: flex;
      justify-content: center;
      align-items: center;
      text-align: center;
      color: #ffffff;
      margin-top: 80px; /* Space above the divider */
      margin-bottom: 80px; /* Space below the divider */
    }

    .divider-section img {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      object-fit: cover;
      z-index: 1;
    }

    .divider-section-overlay {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      /* background: rgba(0, 0, 0, 0.4); Dark overlay for text readability */
      z-index: 2;
    }

    .divider-content {
    position: absolute;
      bottom: 50px; /* Position at the bottom */
      left: 50%;
      transform: translateX(-50%); /* Center horizontally */
      z-index: 5; /* Ensure text is above the image */
      color: #ffffff; /* White text for readability */
      text-align: center;
      width: 90%; /* Adjust width for smaller appearance */
      max-width: 800px; /* Max width to prevent it from getting too wide */
      padding: 20px 30px; /* Add some padding */
      background-color: rgba(0, 0, 0, 0); /* Slightly darker background for text readability */
      border-radius: 8px;
    }

    .divider-content h2 {
      font-size: 2rem; /* Title is a bit smaller than before, still prominent */
      font-weight: 700;
      margin-bottom: 10px; /* Space between title and body */
      text-shadow: 1px 1px 3px rgba(0, 0, 0, 0.5); /* Subtle text shadow */
      line-height: 1.2;
      text-transform: uppercase; /* Match the image's uppercase style */
      letter-spacing: 2px;
      
    }

    .divider-title {
      font-size: 2rem; /* Title is a bit smaller than before, still prominent */
      font-weight: 700;
      margin-bottom: 10px; /* Space between title and body */
      text-shadow: 1px 1px 3px rgba(0, 0, 0, 0.5); /* Subtle text shadow */
      line-height: 1.2;
      text-transform: uppercase; /* Match the image's uppercase style */
      letter-spacing: 2px;
    }

    .divider-body {
      font-size: 1rem; /* Smaller font size for the body text */
      font-weight: 400;
      line-height: 1.6;
      max-width: 600px; /* Limit body text width for readability */
      margin: 0 auto; /* Center the body text */
    }

    /* Responsive adjustments */
    @media (max-width: 768px) {
      .site-header .main-nav {
        display: none; /* Hide desktop nav on mobile */
      }

      .site-header .hamburger-menu {
        display: block; /* Show hamburger on mobile */
      }

      .site-header .container {
        justify-content: space-between; /* Ensure logo is left, hamburger is right */
        width: 100%;
      }

      .site-header {
        padding: 20px;
        flex-direction: row; /* Keep logo and hamburger horizontal */
      }

      /* Hamburger menu animation for active state */
      .hamburger-menu.is-active .bar:nth-child(1) {
        transform: translateY(8px) rotate(45deg);
      }
      .hamburger-menu.is-active .bar:nth-child(2) {
        opacity: 0;
      }
      .hamburger-menu.is-active .bar:nth-child(3) {
        transform: translateY(-8px) rotate(-45deg);
      }

      .slider {
        height: 60vh;
      }

      /* Responsive for slider overlay text */
      .slide-title {
        font-size: 1.8rem;
      }

      .slide-body {
        font-size: 0.9rem;
      }

      .slide-content {
        bottom: 30px;
        padding: 15px 20px;
      }


      .project-thumbnail-container img {
        height: 300px; /* Adjust image height for mobile */
      }

      .project-title {
        font-size: 1.3rem;
      }

      .project-description {
        font-size: 0.9rem;
      }

      .section-title {
        font-size: 2rem;
        margin-bottom: 40px;
        padding-top: 40px;
      }

      .slider-arrow {
        padding: 10px; /* Smaller padding on mobile */
      }

      .slider-arrow svg {
        width: 20px; /* Smaller arrow icon on mobile */
        height: 20px;
      }

      .divider-section {
        height: 40vh; /* Adjust height for mobile */
        margin-top: 40px;
        margin-bottom: 40px;
      }

      .divider-content h2 {
        font-size: 2rem;
      }
    }

    @media (max-width: 480px) {
      .site-header {
        padding: 15px 10px;
      }
      .mobile-nav a {
        font-size: 1.3rem;
      }
      .project-list {
        padding: 30px 15px;
        gap: 30px;
      }
      .section-title {
        font-size: 1.8rem;
      }
      
      /* Responsive for slider overlay text on very small screens */
      .slide-title {
        font-size: 1.5rem;
      }

      .slide-body {
        font-size: 0.8rem;
      }

      .slide-content {
        bottom: 20px;
        padding: 10px 15px;
      }

      .divider-content h2 {
        font-size: 1.5rem;
      }
    }

  </style>
</head>
<body>
<header class="site-header">
  <div class="container">
    <a href="home.html" class="logo">AMONTON</a>
    <button class="hamburger-menu" aria-label="Toggle navigation">
        <span class="bar"></span>
        <span class="bar"></span>
        <span class="bar"></span>
    </button>
    <nav class="main-nav"> <!-- Desktop Navigation -->
      <a href="home.html" class="nav_link">Home</a>
      <a href="about.html" class="nav_link">About</a>
      <a href="contact.html" class="nav_link">Contact</a>
    </nav>
  </div>
  <div class="mobile-nav-overlay"> <!-- Mobile Navigation Overlay -->
    <nav class="mobile-nav">
      <a href="home.html" class="nav_link">Home</a>
      <a href="about.html" class="nav_link">About</a>
      <a href="contact.html" class="nav_link">Contact</a>
    </nav>
  </div>
</header>

<div class="slider" id="main-slider">
  <div class="slide-track" id="slide-track">
    <!-- Slides will be injected here by JavaScript -->
  </div>
  <div class="dots" id="slider-dots">
    <!-- Dots will be injected here by JavaScript -->
  </div>

  <!-- Slider Navigation Arrows -->
  <button class="slider-arrow left" id="left-arrow" aria-label="Previous slide">
    <svg viewBox="0 0 24 24">
      <path d="M15.41 16.59L10.83 12l4.58-4.59L14 6l-6 6 6 6z"/>
    </svg>
  </button>
  <button class="slider-arrow right" id="right-arrow" aria-label="Next slide">
    <svg viewBox="0 0 24 24">
      <path d="M8.59 16.59L13.17 12 8.59 7.41 10 6l6 6-6 6z"/>
    </svg>
  </button>
</div>


  <h2 class="section-title">Latest Work</h2> <!-- Added "Latest Work" title -->
  <main class="project-list" id="projectList">
    <!-- Projects will be injected by JavaScript -->
  </main>

  <section class="divider-section" id="dividerSection">
    </section>

    
  <h2 class="section-title">Architecture</h2> <main class="project-list" id="CategoryProjectList">
    </main>
  

  <script>
   async function loadProjects(file, elem_id) {
    try {
        // 1. Fetch the index.json which now primarily provides folder and basic info
        const response = await fetch(file);
        const projectsSummary = await response.json(); // Renamed to avoid confusion with full project data

        const projectList = document.getElementById(elem_id);

        // Use Promise.all to fetch all individual metadata files concurrently for better performance
        const projectsWithFullMetadata = await Promise.all(
        projectsSummary.map(async (project) => {
            try {
            const metadataResponse = await fetch(`projects/${project.folder}/metadata.json`);
            const projectMetadata = await metadataResponse.json();

            // Merge the summary data with the full metadata
            return {
                ...project, // Keep folder, title, description, thumbnail, size from index.json
                category: projectMetadata.category, // Get category from metadata.json
                year: projectMetadata.year, // Get year from metadata.json
                fullDescription: projectMetadata.thumbnail_desc, // You might want to use the full description from metadata.json
                title: projectMetadata.title,
                thumbnail: projectMetadata.thumbnail_photo

            };
            } catch (metadataError) {
            console.error(`Failed to load metadata for project ${project.folder}:`, metadataError);
            // Return the project summary as fallback if metadata fails to load
            return {
                ...project,
                category: project.category || ['Not specified'], // Fallback to index.json category or default
                year: project.year || 'N/A', // Fallback to index.json year or default
                fullDescription: project.description, // Use description from index.json as fallback
                title: project.title || 'Project Title',
                thumbnail: project.thumbnail || 'https://placehold.co/600x400/eeeeee/333333?text=Project+Image'
            };
            }
        })
        );

        projectsWithFullMetadata.forEach(project => {
        const anchor = document.createElement('a');
        anchor.href = `projects/${project.folder}/index.html`; // Link to individual project page
        anchor.className = 'project';

        const thumbnailContainer = document.createElement('div');
        thumbnailContainer.className = 'project-thumbnail-container';

        const img = document.createElement('img');
        // Use project.thumbnail if specified, otherwise default to photos.jpg
        img.src = `projects/${project.folder}/${project.thumbnail || 'photos.jpg'}`;
        img.alt = `${project.title} Thumbnail`;
        img.onerror = function() {
            this.onerror = null;
            this.src = 'https://placehold.co/600x400/eeeeee/333333?text=Project+Image'; // Fallback placeholder
        };
        thumbnailContainer.appendChild(img);
        
        const projectInfo = document.createElement('div');
        projectInfo.className = 'project-info';
        
        const title = document.createElement('h3'); // Changed to h3 for semantic structure
        title.className = 'project-title';
        title.textContent = project.title;
        projectInfo.appendChild(title);
        
        const description = document.createElement('p');
        description.className = 'project-description';
        // Use the fullDescription from metadata.json if available, otherwise fallback to project.description
        description.textContent = project.fullDescription || project.description;
        projectInfo.appendChild(description);
        
        const meta = document.createElement('div');
        meta.className = 'project-meta';
        // Now using category and year fetched from project's metadata.json
        const categoryValueText = Array.isArray(project.category) ? project.category.join(' | ') : project.category || 'Not specified';
        meta.textContent = `${categoryValueText} | ${project.year ? project.year : ''}`; // Add category and year
        projectInfo.appendChild(meta);
        
        if (project.size && window.innerWidth >= 768) {
            anchor.style.gridColumn = `span ${project.size}`;
        }
        anchor.appendChild(thumbnailContainer);
        anchor.appendChild(projectInfo);

        projectList.appendChild(anchor);
        });
    } catch (error) {
        console.error('Failed to load projects:', error);
        // Optionally display a user-friendly message if projects fail to load
        const projectList = document.getElementById(elem_id); // Use elem_id here
        projectList.innerHTML = '<p style="text-align: center; color: #888;">Failed to load projects. Please ensure projects/index.json and individual project metadata.json files exist and are correctly formatted.</p>';
    }
    }

    async function loadDivider(i, divider_id) {
      try {
        const response = await fetch('slider/dividers.json');
        const dividers = await response.json();
        
        const dividerSection = document.getElementById(divider_id);
        if (dividers.length > i) {
          // For simplicity, let's just pick the first divider for now
          const divider = dividers[i]; 

          const img = document.createElement('img');
          img.src = `slider/${divider.image}`;
          img.alt = "Divider Image";

          const overlay = document.createElement('div');
          overlay.className = 'divider-section-overlay';

          const content = document.createElement('div');
          content.className = 'divider-content';
          const title = document.createElement('h2');
          title.textContent = divider.text;
          content.appendChild(title);

          dividerSection.appendChild(img);
          dividerSection.appendChild(overlay);
          dividerSection.appendChild(content);

        } else {
          dividerSection.style.display = 'none'; // Hide if no dividers
        }

      } catch (error) {
        console.error('Failed to load dividers:', error);
        const dividerSection = document.getElementById('dividerSection');
        dividerSection.style.display = 'none'; // Hide section if there's an error
      }
    }

    let currentIndex = 0;
    let slideInterval;
    let sliderData = []; // To store the loaded slider data
    let totalSlides = 0; // Will be updated after loading data

    const mainSlider = document.getElementById('main-slider'); // Get the main slider container
    const slideTrack = document.getElementById('slide-track'); // Get the slide track
    const dotsContainer = document.getElementById('slider-dots'); // Get the dots container
    const leftArrow = document.getElementById('left-arrow'); // Get left arrow
    const rightArrow = document.getElementById('right-arrow'); // Get right arrow

    async function loadSlider() {
      try {
        const response = await fetch('slider/slider_data.json'); // Fetch your new slider data JSON
        sliderData = await response.json(); // Store the data
        totalSlides = sliderData.length;

        // Clear existing slides and dots
        slideTrack.innerHTML = '';
        dotsContainer.innerHTML = '';

        // Create slides and dots dynamically
        sliderData.forEach((slide, index) => {
          // Create slide div
          const slideDiv = document.createElement('div');
          slideDiv.className = 'slide';

          // Create image element
          const img = document.createElement('img');
          img.src = `slider/${slide.image}`; // Use image path from JSON
          img.alt = `Slide ${index + 1}`;
          // Fallback image in case the specified image is not found
          img.onerror = function() {
            this.onerror=null;
            this.src='https://placehold.co/1920x1080/eeeeee/333333?text=Slide+Image';
          };
          slideDiv.appendChild(img);

          // Create overlay text if available
          if (slide.title || slide.body) { // Check for either title or body
            const contentDiv = document.createElement('div');
            contentDiv.className = 'slide-content';

            if (slide.title) {
                const h2 = document.createElement('h2');
                h2.className = 'slide-title'; /* Added class for title */
                h2.textContent = slide.title;
                contentDiv.appendChild(h2);
            }
            
            if (slide.body) {
                const p = document.createElement('p');
                p.className = 'slide-body'; /* Added class for body */
                p.textContent = slide.body;
                contentDiv.appendChild(p);
            }
            slideDiv.appendChild(contentDiv);
          }

          slideTrack.appendChild(slideDiv);

          // Create dot
          const dot = document.createElement('span');
          dot.className = 'dot';
          dot.dataset.index = index;
          if (index === 0) {
            dot.classList.add('active'); // First dot active by default
          }
          dotsContainer.appendChild(dot);

          dot.addEventListener('click', () => {
            goToSlide(parseInt(dot.dataset.index));
            resetAutoSlide();
          });
        });

        // Initialize slider functionality only after content is loaded
        goToSlide(0);
        startAutoSlide();

        // Add event listeners for arrows (moved here to ensure elements exist)
        leftArrow.addEventListener('click', () => {
          goToSlide(currentIndex - 1);
          resetAutoSlide();
        });

        rightArrow.addEventListener('click', () => {
          goToSlide(currentIndex + 1);
          resetAutoSlide();
        });

        // Pause/play on hover
        mainSlider.addEventListener('mouseenter', () => clearInterval(slideInterval));
        mainSlider.addEventListener('mouseleave', () => startAutoSlide());

      } catch (error) {
        console.error('Failed to load slider data:', error);
        // Optionally hide the slider or display an error message
        if (mainSlider) {
          mainSlider.style.display = 'none'; // Hide the slider if data fails to load
        }
      }
    }

    function goToSlide(index) {
      if (index < 0) {
        currentIndex = totalSlides - 1;
      } else if (index >= totalSlides) {
        currentIndex = 0;
      } else {
        currentIndex = index;
      }

      slideTrack.style.transform = `translateX(-${currentIndex * 100}%)`;
      // Re-query dots as they are dynamically created
      document.querySelectorAll('.dots .dot').forEach(dot => dot.classList.remove('active'));
      document.querySelectorAll('.dots .dot')[currentIndex].classList.add('active');
    }

    function startAutoSlide() {
      slideInterval = setInterval(() => {
        goToSlide(currentIndex + 1);
      }, 7000);
    }

    function resetAutoSlide() {
      clearInterval(slideInterval);
      startAutoSlide();
    }

    // Call loadSlider when the DOM is fully loaded
    document.addEventListener('DOMContentLoaded', () => {
        loadSlider(); // Load the main slider first
        loadProjects('projects/index.json', 'projectList'); // Then load projects
        loadDivider(0, 'dividerSection'); // Load the divider
        loadProjects('projects/arch.json', 'CategoryProjectList'); // Load category projects
    });


    // --- Hamburger Menu Logic ---
    const hamburgerMenu = document.querySelector('.hamburger-menu');
    const mobileNavOverlay = document.querySelector('.mobile-nav-overlay');
    const mobileNavLinks = document.querySelectorAll('.mobile-nav .nav_link');

    hamburgerMenu.addEventListener('click', () => {
      hamburgerMenu.classList.toggle('is-active');
      mobileNavOverlay.classList.toggle('is-open');
      document.body.style.overflow = mobileNavOverlay.classList.contains('is-open') ? 'hidden' : '';
    });

    mobileNavLinks.forEach(link => {
      link.addEventListener('click', () => {
        hamburgerMenu.classList.remove('is-active');
        mobileNavOverlay.classList.remove('is-open');
        document.body.style.overflow = '';
      });
    });

    mobileNavOverlay.addEventListener('click', (event) => {
        if (event.target === mobileNavOverlay) {
            hamburgerMenu.classList.remove('is-active');
            mobileNavOverlay.classList.remove('is-open');
            document.body.style.overflow = '';
        }
    });

    // --- Header Scroll Logic ---
    const siteHeader = document.querySelector('.site-header');
    const sliderElement = document.querySelector('.slider');

    function checkHeaderBackground() {
        const sliderBottom = sliderElement.getBoundingClientRect().bottom;

        // Change header background if scrolled past the slider's bottom edge
        if (window.scrollY > sliderBottom - siteHeader.offsetHeight) {
            siteHeader.classList.add('scrolled');
        } else {
            siteHeader.classList.remove('scrolled');
        }
    }

    window.addEventListener('scroll', checkHeaderBackground);
    window.addEventListener('load', checkHeaderBackground);

  </script>
</body>
</html>
